

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>moviepy.video.VideoClip &mdash; MoviePy  documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> MoviePy
          

          
            
            <img src="../../../_static/logo_small.jpeg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Download and Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started/getting_started.html">Getting started with MoviePy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gallery.html">Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/examples.html">Example Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docker.html">Moviepy Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../opencv_instructions.html">So you want to install OpenCV 2.4.6 ?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../FAQ.html">FAQ and troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../advanced_tools/advanced_tools.html">Advanced tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ref/ref.html">Reference Manual</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">MoviePy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>moviepy.video.VideoClip</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for moviepy.video.VideoClip</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This module implements VideoClip (base class for video clips) and its</span>
<span class="sd">main subclasses:</span>
<span class="sd">- Animated clips:     VideofileClip, ImageSequenceClip</span>
<span class="sd">- Static image clips: ImageClip, ColorClip, TextClip,</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">subprocess</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">tempfile</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">proglog</span>
<span class="kn">from</span> <span class="nn">imageio</span> <span class="kn">import</span> <span class="n">imread</span><span class="p">,</span> <span class="n">imsave</span>

<span class="kn">from</span> <span class="nn">..Clip</span> <span class="kn">import</span> <span class="n">Clip</span>
<span class="kn">from</span> <span class="nn">..compat</span> <span class="kn">import</span> <span class="n">DEVNULL</span><span class="p">,</span> <span class="n">string_types</span>
<span class="kn">from</span> <span class="nn">..config</span> <span class="kn">import</span> <span class="n">get_setting</span>
<span class="kn">from</span> <span class="nn">..decorators</span> <span class="kn">import</span> <span class="p">(</span><span class="n">add_mask_if_none</span><span class="p">,</span> <span class="n">apply_to_mask</span><span class="p">,</span>
                          <span class="n">convert_masks_to_RGB</span><span class="p">,</span> <span class="n">convert_to_seconds</span><span class="p">,</span> <span class="n">outplace</span><span class="p">,</span>
                          <span class="n">requires_duration</span><span class="p">,</span> <span class="n">use_clip_fps_by_default</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">..tools</span> <span class="kn">import</span> <span class="p">(</span><span class="n">deprecated_version_of</span><span class="p">,</span> <span class="n">extensions_dict</span><span class="p">,</span> <span class="n">find_extension</span><span class="p">,</span>
                     <span class="n">is_string</span><span class="p">,</span> <span class="n">subprocess_call</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.io.ffmpeg_writer</span> <span class="kn">import</span> <span class="n">ffmpeg_write_video</span>
<span class="kn">from</span> <span class="nn">.io.gif_writers</span> <span class="kn">import</span> <span class="p">(</span><span class="n">write_gif</span><span class="p">,</span> <span class="n">write_gif_with_image_io</span><span class="p">,</span>
                             <span class="n">write_gif_with_tempfiles</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.tools.drawing</span> <span class="kn">import</span> <span class="n">blit</span>


<div class="viewcode-block" id="VideoClip"><a class="viewcode-back" href="../../../ref/VideoClip/VideoClip.html#moviepy.video.VideoClip.VideoClip">[docs]</a><span class="k">class</span> <span class="nc">VideoClip</span><span class="p">(</span><span class="n">Clip</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for video clips.</span>

<span class="sd">    See ``VideoFileClip``, ``ImageClip`` etc. for more user-friendly</span>
<span class="sd">    classes.</span>


<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>

<span class="sd">    ismask</span>
<span class="sd">      `True` if the clip is going to be used as a mask.</span>


<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>

<span class="sd">    size</span>
<span class="sd">      The size of the clip, (width,heigth), in pixels.</span>

<span class="sd">    w, h</span>
<span class="sd">      The width and height of the clip, in pixels.</span>

<span class="sd">    ismask</span>
<span class="sd">      Boolean set to `True` if the clip is a mask.</span>

<span class="sd">    make_frame</span>
<span class="sd">      A function ``t-&gt; frame at time t`` where ``frame`` is a</span>
<span class="sd">      w*h*3 RGB array.</span>

<span class="sd">    mask (default None)</span>
<span class="sd">      VideoClip mask attached to this clip. If mask is ``None``,</span>
<span class="sd">                The video clip is fully opaque.</span>

<span class="sd">    audio (default None)</span>
<span class="sd">      An AudioClip instance containing the audio of the video clip.</span>

<span class="sd">    pos</span>
<span class="sd">      A function ``t-&gt;(x,y)`` where ``x,y`` is the position</span>
<span class="sd">      of the clip when it is composed with other clips.</span>
<span class="sd">      See ``VideoClip.set_pos`` for more details</span>

<span class="sd">    relative_pos</span>
<span class="sd">      See variable ``pos``.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">make_frame</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ismask</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">has_constant_size</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">Clip</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">audio</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relative_pos</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">make_frame</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">make_frame</span> <span class="o">=</span> <span class="n">make_frame</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_frame</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ismask</span> <span class="o">=</span> <span class="n">ismask</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">has_constant_size</span><span class="o">=</span><span class="n">has_constant_size</span>
        <span class="k">if</span> <span class="n">duration</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="n">duration</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">duration</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">w</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">h</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">aspect_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">)</span>

    <span class="c1"># ===============================================================</span>
    <span class="c1"># EXPORT OPERATIONS</span>

<div class="viewcode-block" id="VideoClip.save_frame"><a class="viewcode-back" href="../../../ref/VideoClip/VideoClip.html#moviepy.video.VideoClip.VideoClip.save_frame">[docs]</a>    <span class="nd">@convert_to_seconds</span><span class="p">([</span><span class="s1">&#39;t&#39;</span><span class="p">])</span>
    <span class="nd">@convert_masks_to_RGB</span>
    <span class="k">def</span> <span class="nf">save_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">withmask</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Save a clip&#39;s frame to an image file.</span>

<span class="sd">        Saves the frame of clip corresponding to time ``t`` in</span>
<span class="sd">        &#39;filename&#39;. ``t`` can be expressed in seconds (15.35), in</span>
<span class="sd">        (min, sec), in (hour, min, sec), or as a string: &#39;01:03:05.35&#39;.</span>

<span class="sd">        If ``withmask`` is ``True`` the mask is saved in</span>
<span class="sd">        the alpha layer of the picture (only works with PNGs).</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_frame</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">withmask</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="mi">255</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">get_frame</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="n">im</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">([</span><span class="n">im</span><span class="p">,</span> <span class="n">mask</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">im</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;uint8&quot;</span><span class="p">)</span>

        <span class="n">imsave</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">im</span><span class="p">)</span></div>

<div class="viewcode-block" id="VideoClip.write_videofile"><a class="viewcode-back" href="../../../ref/VideoClip/VideoClip.html#moviepy.video.VideoClip.VideoClip.write_videofile">[docs]</a>    <span class="nd">@requires_duration</span>
    <span class="nd">@use_clip_fps_by_default</span>
    <span class="nd">@convert_masks_to_RGB</span>
    <span class="k">def</span> <span class="nf">write_videofile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">codec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">bitrate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">audio</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">audio_fps</span><span class="o">=</span><span class="mi">44100</span><span class="p">,</span>
                        <span class="n">preset</span><span class="o">=</span><span class="s2">&quot;medium&quot;</span><span class="p">,</span>
                        <span class="n">audio_nbytes</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">audio_codec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">audio_bitrate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">audio_bufsize</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span>
                        <span class="n">temp_audiofile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">rewrite_audio</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_temp</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">write_logfile</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">threads</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ffmpeg_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">logger</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Write the clip to a videofile.</span>

<span class="sd">        Parameters</span>
<span class="sd">        -----------</span>

<span class="sd">        filename</span>
<span class="sd">          Name of the video file to write in.</span>
<span class="sd">          The extension must correspond to the &quot;codec&quot; used (see below),</span>
<span class="sd">          or simply be &#39;.avi&#39; (which will work with any codec).</span>

<span class="sd">        fps</span>
<span class="sd">          Number of frames per second in the resulting video file. If None is</span>
<span class="sd">          provided, and the clip has an fps attribute, this fps will be used.</span>

<span class="sd">        codec</span>
<span class="sd">          Codec to use for image encoding. Can be any codec supported</span>
<span class="sd">          by ffmpeg. If the filename is has extension &#39;.mp4&#39;, &#39;.ogv&#39;, &#39;.webm&#39;,</span>
<span class="sd">          the codec will be set accordingly, but you can still set it if you</span>
<span class="sd">          don&#39;t like the default. For other extensions, the output filename</span>
<span class="sd">          must be set accordingly.</span>

<span class="sd">          Some examples of codecs are:</span>

<span class="sd">          ``&#39;libx264&#39;`` (default codec for file extension ``.mp4``)</span>
<span class="sd">          makes well-compressed videos (quality tunable using &#39;bitrate&#39;).</span>


<span class="sd">          ``&#39;mpeg4&#39;`` (other codec for extension ``.mp4``) can be an alternative</span>
<span class="sd">          to ``&#39;libx264&#39;``, and produces higher quality videos by default.</span>


<span class="sd">          ``&#39;rawvideo&#39;`` (use file extension ``.avi``) will produce</span>
<span class="sd">          a video of perfect quality, of possibly very huge size.</span>


<span class="sd">          ``png`` (use file extension ``.avi``) will produce a video</span>
<span class="sd">          of perfect quality, of smaller size than with ``rawvideo``.</span>


<span class="sd">          ``&#39;libvorbis&#39;`` (use file extension ``.ogv``) is a nice video</span>
<span class="sd">          format, which is completely free/ open source. However not</span>
<span class="sd">          everyone has the codecs installed by default on their machine.</span>


<span class="sd">          ``&#39;libvpx&#39;`` (use file extension ``.webm``) is tiny a video</span>
<span class="sd">          format well indicated for web videos (with HTML5). Open source.</span>


<span class="sd">        audio</span>
<span class="sd">          Either ``True``, ``False``, or a file name.</span>
<span class="sd">          If ``True`` and the clip has an audio clip attached, this</span>
<span class="sd">          audio clip will be incorporated as a soundtrack in the movie.</span>
<span class="sd">          If ``audio`` is the name of an audio file, this audio file</span>
<span class="sd">          will be incorporated as a soundtrack in the movie.</span>

<span class="sd">        audiofps</span>
<span class="sd">          frame rate to use when generating the sound.</span>

<span class="sd">        temp_audiofile</span>
<span class="sd">          the name of the temporary audiofile to be generated and</span>
<span class="sd">          incorporated in the the movie, if any.</span>

<span class="sd">        audio_codec</span>
<span class="sd">          Which audio codec should be used. Examples are &#39;libmp3lame&#39;</span>
<span class="sd">          for &#39;.mp3&#39;, &#39;libvorbis&#39; for &#39;ogg&#39;, &#39;libfdk_aac&#39;:&#39;m4a&#39;,</span>
<span class="sd">          &#39;pcm_s16le&#39; for 16-bit wav and &#39;pcm_s32le&#39; for 32-bit wav.</span>
<span class="sd">          Default is &#39;libmp3lame&#39;, unless the video extension is &#39;ogv&#39;</span>
<span class="sd">          or &#39;webm&#39;, at which case the default is &#39;libvorbis&#39;.</span>

<span class="sd">        audio_bitrate</span>
<span class="sd">          Audio bitrate, given as a string like &#39;50k&#39;, &#39;500k&#39;, &#39;3000k&#39;.</span>
<span class="sd">          Will determine the size/quality of audio in the output file.</span>
<span class="sd">          Note that it mainly an indicative goal, the bitrate won&#39;t</span>
<span class="sd">          necessarily be the this in the final file.</span>

<span class="sd">        preset</span>
<span class="sd">          Sets the time that FFMPEG will spend optimizing the compression.</span>
<span class="sd">          Choices are: ultrafast, superfast, veryfast, faster, fast, medium,</span>
<span class="sd">          slow, slower, veryslow, placebo. Note that this does not impact</span>
<span class="sd">          the quality of the video, only the size of the video file. So</span>
<span class="sd">          choose ultrafast when you are in a hurry and file size does not</span>
<span class="sd">          matter.</span>

<span class="sd">        threads</span>
<span class="sd">          Number of threads to use for ffmpeg. Can speed up the writing of</span>
<span class="sd">          the video on multicore computers.</span>

<span class="sd">        ffmpeg_params</span>
<span class="sd">          Any additional ffmpeg parameters you would like to pass, as a list</span>
<span class="sd">          of terms, like [&#39;-option1&#39;, &#39;value1&#39;, &#39;-option2&#39;, &#39;value2&#39;].</span>

<span class="sd">        write_logfile</span>
<span class="sd">          If true, will write log files for the audio and the video.</span>
<span class="sd">          These will be files ending with &#39;.log&#39; with the name of the</span>
<span class="sd">          output file in them.</span>

<span class="sd">        logger</span>
<span class="sd">          Either &quot;bar&quot; for progress bar or None or any Proglog logger.</span>

<span class="sd">        verbose (deprecated, kept for compatibility)</span>
<span class="sd">          Formerly used for toggling messages on/off. Use logger=None now.</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>

<span class="sd">        &gt;&gt;&gt; from moviepy.editor import VideoFileClip</span>
<span class="sd">        &gt;&gt;&gt; clip = VideoFileClip(&quot;myvideo.mp4&quot;).subclip(100,120)</span>
<span class="sd">        &gt;&gt;&gt; clip.write_videofile(&quot;my_new_video.mp4&quot;)</span>
<span class="sd">        &gt;&gt;&gt; clip.close()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="n">ext</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">logger</span> <span class="o">=</span> <span class="n">proglog</span><span class="o">.</span><span class="n">default_bar_logger</span><span class="p">(</span><span class="n">logger</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">codec</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">codec</span> <span class="o">=</span> <span class="n">extensions_dict</span><span class="p">[</span><span class="n">ext</span><span class="p">][</span><span class="s1">&#39;codec&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;MoviePy couldn&#39;t find the codec associated &quot;</span>
                                 <span class="s2">&quot;with the filename. Provide the &#39;codec&#39; &quot;</span>
                                 <span class="s2">&quot;parameter in write_videofile.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">audio_codec</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ext</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ogv&#39;</span><span class="p">,</span> <span class="s1">&#39;webm&#39;</span><span class="p">]:</span>
                <span class="n">audio_codec</span> <span class="o">=</span> <span class="s1">&#39;libvorbis&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">audio_codec</span> <span class="o">=</span> <span class="s1">&#39;libmp3lame&#39;</span>
        <span class="k">elif</span> <span class="n">audio_codec</span> <span class="o">==</span> <span class="s1">&#39;raw16&#39;</span><span class="p">:</span>
            <span class="n">audio_codec</span> <span class="o">=</span> <span class="s1">&#39;pcm_s16le&#39;</span>
        <span class="k">elif</span> <span class="n">audio_codec</span> <span class="o">==</span> <span class="s1">&#39;raw32&#39;</span><span class="p">:</span>
            <span class="n">audio_codec</span> <span class="o">=</span> <span class="s1">&#39;pcm_s32le&#39;</span>

        <span class="n">audiofile</span> <span class="o">=</span> <span class="n">audio</span> <span class="k">if</span> <span class="n">is_string</span><span class="p">(</span><span class="n">audio</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">make_audio</span> <span class="o">=</span> <span class="p">((</span><span class="n">audiofile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">audio</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)</span> <span class="ow">and</span>
                      <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">audio</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">make_audio</span> <span class="ow">and</span> <span class="n">temp_audiofile</span><span class="p">:</span>
            <span class="c1"># The audio will be the clip&#39;s audio</span>
            <span class="n">audiofile</span> <span class="o">=</span> <span class="n">temp_audiofile</span>
        <span class="k">elif</span> <span class="n">make_audio</span><span class="p">:</span>
            <span class="n">audio_ext</span> <span class="o">=</span> <span class="n">find_extension</span><span class="p">(</span><span class="n">audio_codec</span><span class="p">)</span>
            <span class="n">audiofile</span> <span class="o">=</span> <span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="n">Clip</span><span class="o">.</span><span class="n">_TEMP_FILES_PREFIX</span> <span class="o">+</span> <span class="s2">&quot;wvf_snd.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">audio_ext</span><span class="p">)</span>

        <span class="c1"># enough cpu for multiprocessing ? USELESS RIGHT NOW, WILL COME AGAIN</span>
        <span class="c1"># enough_cpu = (multiprocessing.cpu_count() &gt; 1)</span>
        <span class="n">logger</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;Moviepy - Building video </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">make_audio</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">audio</span><span class="o">.</span><span class="n">write_audiofile</span><span class="p">(</span><span class="n">audiofile</span><span class="p">,</span> <span class="n">audio_fps</span><span class="p">,</span>
                                       <span class="n">audio_nbytes</span><span class="p">,</span> <span class="n">audio_bufsize</span><span class="p">,</span>
                                       <span class="n">audio_codec</span><span class="p">,</span> <span class="n">bitrate</span><span class="o">=</span><span class="n">audio_bitrate</span><span class="p">,</span>
                                       <span class="n">write_logfile</span><span class="o">=</span><span class="n">write_logfile</span><span class="p">,</span>
                                       <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                                       <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>

        <span class="n">ffmpeg_write_video</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">fps</span><span class="p">,</span> <span class="n">codec</span><span class="p">,</span>
                           <span class="n">bitrate</span><span class="o">=</span><span class="n">bitrate</span><span class="p">,</span>
                           <span class="n">preset</span><span class="o">=</span><span class="n">preset</span><span class="p">,</span>
                           <span class="n">write_logfile</span><span class="o">=</span><span class="n">write_logfile</span><span class="p">,</span>
                           <span class="n">audiofile</span><span class="o">=</span><span class="n">audiofile</span><span class="p">,</span>
                           <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">threads</span><span class="o">=</span><span class="n">threads</span><span class="p">,</span>
                           <span class="n">ffmpeg_params</span><span class="o">=</span><span class="n">ffmpeg_params</span><span class="p">,</span>
                           <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">remove_temp</span> <span class="ow">and</span> <span class="n">make_audio</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">audiofile</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">audiofile</span><span class="p">)</span>
        <span class="n">logger</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;Moviepy - video ready </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">filename</span><span class="p">)</span></div>

<div class="viewcode-block" id="VideoClip.write_images_sequence"><a class="viewcode-back" href="../../../ref/VideoClip/VideoClip.html#moviepy.video.VideoClip.VideoClip.write_images_sequence">[docs]</a>    <span class="nd">@requires_duration</span>
    <span class="nd">@use_clip_fps_by_default</span>
    <span class="nd">@convert_masks_to_RGB</span>
    <span class="k">def</span> <span class="nf">write_images_sequence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nameformat</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">withmask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Writes the videoclip to a sequence of image files.</span>

<span class="sd">        Parameters</span>
<span class="sd">        -----------</span>

<span class="sd">        nameformat</span>
<span class="sd">          A filename specifying the numerotation format and extension</span>
<span class="sd">          of the pictures. For instance &quot;frame%03d.png&quot; for filenames</span>
<span class="sd">          indexed with 3 digits and PNG format. Also possible:</span>
<span class="sd">          &quot;some_folder/frame%04d.jpeg&quot;, etc.</span>

<span class="sd">        fps</span>
<span class="sd">          Number of frames per second to consider when writing the</span>
<span class="sd">          clip. If not specified, the clip&#39;s ``fps`` attribute will</span>
<span class="sd">          be used if it has one.</span>

<span class="sd">        withmask</span>
<span class="sd">          will save the clip&#39;s mask (if any) as an alpha canal (PNGs only).</span>

<span class="sd">        verbose</span>
<span class="sd">          Boolean indicating whether to print information.</span>

<span class="sd">        logger</span>
<span class="sd">          Either &#39;bar&#39; (progress bar) or None or any Proglog logger.</span>


<span class="sd">        Returns</span>
<span class="sd">        --------</span>

<span class="sd">        names_list</span>
<span class="sd">          A list of all the files generated.</span>

<span class="sd">        Notes</span>
<span class="sd">        ------</span>

<span class="sd">        The resulting image sequence can be read using e.g. the class</span>
<span class="sd">        ``ImageSequenceClip``.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span> <span class="o">=</span> <span class="n">proglog</span><span class="o">.</span><span class="n">default_bar_logger</span><span class="p">(</span><span class="n">logger</span><span class="p">)</span>
        <span class="n">logger</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;Moviepy - Writing frames </span><span class="si">%s</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="n">nameformat</span><span class="p">)</span>

        <span class="n">tt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">fps</span><span class="p">)</span>

        <span class="n">filenames</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">logger</span><span class="o">.</span><span class="n">iter_bar</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">tt</span><span class="p">))):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">nameformat</span> <span class="o">%</span> <span class="n">i</span>
            <span class="n">filenames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_frame</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">withmask</span><span class="o">=</span><span class="n">withmask</span><span class="p">)</span>
        <span class="n">logger</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s1">&#39;Moviepy - Done writing frames </span><span class="si">%s</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="n">nameformat</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">filenames</span></div>

<div class="viewcode-block" id="VideoClip.write_gif"><a class="viewcode-back" href="../../../ref/VideoClip/VideoClip.html#moviepy.video.VideoClip.VideoClip.write_gif">[docs]</a>    <span class="nd">@requires_duration</span>
    <span class="nd">@convert_masks_to_RGB</span>
    <span class="k">def</span> <span class="nf">write_gif</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">program</span><span class="o">=</span><span class="s1">&#39;imageio&#39;</span><span class="p">,</span>
                  <span class="n">opt</span><span class="o">=</span><span class="s1">&#39;nq&#39;</span><span class="p">,</span> <span class="n">fuzz</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                  <span class="n">loop</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dispose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tempfiles</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">logger</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; Write the VideoClip to a GIF file.</span>

<span class="sd">        Converts a VideoClip into an animated GIF using ImageMagick</span>
<span class="sd">        or ffmpeg.</span>

<span class="sd">        Parameters</span>
<span class="sd">        -----------</span>

<span class="sd">        filename</span>
<span class="sd">          Name of the resulting gif file.</span>

<span class="sd">        fps</span>
<span class="sd">          Number of frames per second (see note below). If it</span>
<span class="sd">          isn&#39;t provided, then the function will look for the clip&#39;s</span>
<span class="sd">          ``fps`` attribute (VideoFileClip, for instance, have one).</span>

<span class="sd">        program</span>
<span class="sd">          Software to use for the conversion, either &#39;imageio&#39; (this will use</span>
<span class="sd">          the library FreeImage through ImageIO), or &#39;ImageMagick&#39;, or &#39;ffmpeg&#39;.</span>

<span class="sd">        opt</span>
<span class="sd">          Optimalization to apply. If program=&#39;imageio&#39;, opt must be either &#39;wu&#39;</span>
<span class="sd">          (Wu) or &#39;nq&#39; (Neuquant). If program=&#39;ImageMagick&#39;,</span>
<span class="sd">          either &#39;optimizeplus&#39; or &#39;OptimizeTransparency&#39;.</span>

<span class="sd">        fuzz</span>
<span class="sd">          (ImageMagick only) Compresses the GIF by considering that</span>
<span class="sd">          the colors that are less than fuzz% different are in fact</span>
<span class="sd">          the same.</span>

<span class="sd">        tempfiles</span>
<span class="sd">          Writes every frame to a file instead of passing them in the RAM.</span>
<span class="sd">          Useful on computers with little RAM. Can only be used with</span>
<span class="sd">          ImageMagick&#39; or &#39;ffmpeg&#39;.</span>

<span class="sd">        progress_bar</span>
<span class="sd">          If True, displays a progress bar</span>


<span class="sd">        Notes</span>
<span class="sd">        -----</span>

<span class="sd">        The gif will be playing the clip in real time (you can</span>
<span class="sd">        only change the frame rate). If you want the gif to be played</span>
<span class="sd">        slower than the clip you will use ::</span>

<span class="sd">            &gt;&gt;&gt; # slow down clip 50% and make it a gif</span>
<span class="sd">            &gt;&gt;&gt; myClip.speedx(0.5).to_gif(&#39;myClip.gif&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># A little sketchy at the moment, maybe move all that in write_gif,</span>
        <span class="c1">#  refactor a little... we will see.</span>

        <span class="k">if</span> <span class="n">program</span> <span class="o">==</span> <span class="s1">&#39;imageio&#39;</span><span class="p">:</span>
            <span class="n">write_gif_with_image_io</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="n">fps</span><span class="p">,</span> <span class="n">opt</span><span class="o">=</span><span class="n">opt</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
                                    <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
                                    <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">tempfiles</span><span class="p">:</span>
            <span class="c1"># convert imageio opt variable to something that can be used with</span>
            <span class="c1"># ImageMagick</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;optimizeplus&#39;</span> <span class="k">if</span> <span class="n">opt</span> <span class="o">==</span> <span class="s1">&#39;nq&#39;</span> <span class="k">else</span> <span class="s1">&#39;OptimizeTransparency&#39;</span>
            <span class="n">write_gif_with_tempfiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="n">fps</span><span class="p">,</span>
                                     <span class="n">program</span><span class="o">=</span><span class="n">program</span><span class="p">,</span> <span class="n">opt</span><span class="o">=</span><span class="n">opt</span><span class="p">,</span> <span class="n">fuzz</span><span class="o">=</span><span class="n">fuzz</span><span class="p">,</span>
                                     <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
                                     <span class="n">dispose</span><span class="o">=</span><span class="n">dispose</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
                                     <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># convert imageio opt variable to something that can be used with</span>
            <span class="c1"># ImageMagick</span>
            <span class="n">opt</span> <span class="o">=</span> <span class="s1">&#39;optimizeplus&#39;</span> <span class="k">if</span> <span class="n">opt</span> <span class="o">==</span> <span class="s1">&#39;nq&#39;</span> <span class="k">else</span> <span class="s1">&#39;OptimizeTransparency&#39;</span>
            <span class="n">write_gif</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="n">fps</span><span class="p">,</span> <span class="n">program</span><span class="o">=</span><span class="n">program</span><span class="p">,</span>
                      <span class="n">opt</span><span class="o">=</span><span class="n">opt</span><span class="p">,</span> <span class="n">fuzz</span><span class="o">=</span><span class="n">fuzz</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
                      <span class="n">dispose</span><span class="o">=</span><span class="n">dispose</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
                      <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span></div>

    <span class="c1"># -----------------------------------------------------------------</span>
    <span class="c1"># F I L T E R I N G</span>

<div class="viewcode-block" id="VideoClip.subfx"><a class="viewcode-back" href="../../../ref/VideoClip/VideoClip.html#moviepy.video.VideoClip.VideoClip.subfx">[docs]</a>    <span class="k">def</span> <span class="nf">subfx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fx</span><span class="p">,</span> <span class="n">ta</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">tb</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply a transformation to a part of the clip.</span>

<span class="sd">        Returns a new clip in which the function ``fun`` (clip-&gt;clip)</span>
<span class="sd">        has been applied to the subclip between times `ta` and `tb`</span>
<span class="sd">        (in seconds).</span>

<span class="sd">        Examples</span>
<span class="sd">        ---------</span>

<span class="sd">        &gt;&gt;&gt; # The scene between times t=3s and t=6s in ``clip`` will be</span>
<span class="sd">        &gt;&gt;&gt; # be played twice slower in ``newclip``</span>
<span class="sd">        &gt;&gt;&gt; newclip = clip.subapply(lambda c:c.speedx(0.5) , 3,6)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subclip</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ta</span><span class="p">)</span> <span class="k">if</span> <span class="n">ta</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subclip</span><span class="p">(</span><span class="n">ta</span><span class="p">,</span> <span class="n">tb</span><span class="p">)</span><span class="o">.</span><span class="n">fx</span><span class="p">(</span><span class="n">fx</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subclip</span><span class="p">(</span><span class="n">t_start</span><span class="o">=</span><span class="n">tb</span><span class="p">)</span> <span class="k">if</span> <span class="n">tb</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="n">clips</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span> <span class="k">if</span> <span class="n">c</span><span class="p">]</span>

        <span class="c1"># beurk, have to find other solution</span>
        <span class="kn">from</span> <span class="nn">moviepy.video.compositing.concatenate</span> <span class="kn">import</span> <span class="n">concatenate_videoclips</span>

        <span class="k">return</span> <span class="n">concatenate_videoclips</span><span class="p">(</span><span class="n">clips</span><span class="p">)</span><span class="o">.</span><span class="n">set_start</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">)</span></div>

    <span class="c1"># IMAGE FILTERS</span>

<div class="viewcode-block" id="VideoClip.fl_image"><a class="viewcode-back" href="../../../ref/VideoClip/VideoClip.html#moviepy.video.VideoClip.VideoClip.fl_image">[docs]</a>    <span class="k">def</span> <span class="nf">fl_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image_func</span><span class="p">,</span> <span class="n">apply_to</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Modifies the images of a clip by replacing the frame</span>
<span class="sd">        `get_frame(t)` by another frame,  `image_func(get_frame(t))`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">apply_to</span> <span class="o">=</span> <span class="n">apply_to</span> <span class="ow">or</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fl</span><span class="p">(</span><span class="k">lambda</span> <span class="n">gf</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">image_func</span><span class="p">(</span><span class="n">gf</span><span class="p">(</span><span class="n">t</span><span class="p">)),</span> <span class="n">apply_to</span><span class="p">)</span></div>

    <span class="c1"># --------------------------------------------------------------</span>
    <span class="c1"># C O M P O S I T I N G</span>

    <span class="k">def</span> <span class="nf">fill_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pre_array</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)):</span>
        <span class="n">pre_shape</span> <span class="o">=</span> <span class="n">pre_array</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">pre_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">pre_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">post_array</span> <span class="o">=</span> <span class="n">pre_array</span>
        <span class="k">if</span> <span class="n">dx</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">post_array</span> <span class="o">=</span> <span class="n">pre_array</span><span class="p">[:</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="k">elif</span> <span class="n">dx</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">x_1</span> <span class="o">=</span> <span class="p">[[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span> <span class="o">*</span> <span class="n">pre_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">*</span> <span class="n">dx</span>
            <span class="n">post_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">pre_array</span><span class="p">,</span> <span class="n">x_1</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">dy</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">post_array</span> <span class="o">=</span> <span class="n">post_array</span><span class="p">[:,</span> <span class="p">:</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
        <span class="k">elif</span> <span class="n">dy</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">x_1</span> <span class="o">=</span> <span class="p">[[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span> <span class="o">*</span> <span class="n">dy</span><span class="p">]</span> <span class="o">*</span> <span class="n">post_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">post_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">post_array</span><span class="p">,</span> <span class="n">x_1</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">post_array</span>

<div class="viewcode-block" id="VideoClip.blit_on"><a class="viewcode-back" href="../../../ref/VideoClip/VideoClip.html#moviepy.video.VideoClip.VideoClip.blit_on">[docs]</a>    <span class="k">def</span> <span class="nf">blit_on</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">picture</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the result of the blit of the clip&#39;s frame at time `t`</span>
<span class="sd">        on the given `picture`, the position of the clip being given</span>
<span class="sd">        by the clip&#39;s ``pos`` attribute. Meant for compositing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">hf</span><span class="p">,</span> <span class="n">wf</span> <span class="o">=</span> <span class="n">framesize</span> <span class="o">=</span> <span class="n">picture</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ismask</span> <span class="ow">and</span> <span class="n">picture</span><span class="o">.</span><span class="n">max</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">picture</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">blit_on</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">framesize</span><span class="p">),</span> <span class="n">t</span><span class="p">))</span>

        <span class="n">ct</span> <span class="o">=</span> <span class="n">t</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span>  <span class="c1"># clip time</span>

        <span class="c1"># GET IMAGE AND MASK IF ANY</span>

        <span class="n">img</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_frame</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">get_frame</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="k">else</span> <span class="kc">None</span>                
        
        <span class="k">if</span> <span class="n">mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">((</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">or</span> <span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])):</span>
            <span class="n">img</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_array</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

        <span class="n">hi</span><span class="p">,</span> <span class="n">wi</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>

        <span class="c1"># SET POSITION</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>

        <span class="c1"># preprocess short writings of the position</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;center&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="s1">&#39;center&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;center&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;right&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="s1">&#39;center&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;top&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="s1">&#39;top&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;bottom&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="s1">&#39;bottom&#39;</span><span class="p">]}[</span><span class="n">pos</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>

        <span class="c1"># is the position relative (given in % of the clip&#39;s size) ?</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">relative_pos</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">dim</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">wf</span><span class="p">,</span> <span class="n">hf</span><span class="p">]):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">pos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dim</span> <span class="o">*</span> <span class="n">pos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">D</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;center&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">wf</span> <span class="o">-</span> <span class="n">wi</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">:</span> <span class="n">wf</span> <span class="o">-</span> <span class="n">wi</span><span class="p">}</span>
            <span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">D</span><span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">D</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;top&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;center&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">hf</span> <span class="o">-</span> <span class="n">hi</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;bottom&#39;</span><span class="p">:</span> <span class="n">hf</span> <span class="o">-</span> <span class="n">hi</span><span class="p">}</span>
            <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">D</span><span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">blit</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">picture</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span> <span class="n">ismask</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ismask</span><span class="p">)</span></div>

<div class="viewcode-block" id="VideoClip.add_mask"><a class="viewcode-back" href="../../../ref/VideoClip/VideoClip.html#moviepy.video.VideoClip.VideoClip.add_mask">[docs]</a>    <span class="k">def</span> <span class="nf">add_mask</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a mask VideoClip to the VideoClip.</span>

<span class="sd">        Returns a copy of the clip with a completely opaque mask</span>
<span class="sd">        (made of ones). This makes computations slower compared to</span>
<span class="sd">        having a None mask but can be useful in many cases. Choose</span>

<span class="sd">        Set ``constant_size`` to  `False` for clips with moving</span>
<span class="sd">        image size.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_constant_size</span><span class="p">:</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">ColorClip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">ismask</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_mask</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">set_duration</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">duration</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">make_frame</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_frame</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">VideoClip</span><span class="p">(</span><span class="n">ismask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">make_frame</span><span class="o">=</span><span class="n">make_frame</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_mask</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">set_duration</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">duration</span><span class="p">))</span></div>

<div class="viewcode-block" id="VideoClip.on_color"><a class="viewcode-back" href="../../../ref/VideoClip/VideoClip.html#moviepy.video.VideoClip.VideoClip.on_color">[docs]</a>    <span class="k">def</span> <span class="nf">on_color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">pos</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">col_opacity</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Place the clip on a colored background.</span>

<span class="sd">        Returns a clip made of the current clip overlaid on a color</span>
<span class="sd">        clip of a possibly bigger size. Can serve to flatten transparent</span>
<span class="sd">        clips.</span>

<span class="sd">        Parameters</span>
<span class="sd">        -----------</span>

<span class="sd">        size</span>
<span class="sd">          Size (width, height) in pixels of the final clip.</span>
<span class="sd">          By default it will be the size of the current clip.</span>

<span class="sd">        color</span>
<span class="sd">          Background color of the final clip ([R,G,B]).</span>

<span class="sd">        pos</span>
<span class="sd">          Position of the clip in the final clip. &#39;center&#39; is the default</span>

<span class="sd">        col_opacity</span>
<span class="sd">          Parameter in 0..1 indicating the opacity of the colored</span>
<span class="sd">          background.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.compositing.CompositeVideoClip</span> <span class="kn">import</span> <span class="n">CompositeVideoClip</span>

        <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span>
        <span class="k">if</span> <span class="n">pos</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span>
        <span class="n">colorclip</span> <span class="o">=</span> <span class="n">ColorClip</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">col_opacity</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">colorclip</span> <span class="o">=</span> <span class="p">(</span><span class="n">ColorClip</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">duration</span><span class="p">)</span>
                         <span class="o">.</span><span class="n">set_opacity</span><span class="p">(</span><span class="n">col_opacity</span><span class="p">))</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">CompositeVideoClip</span><span class="p">([</span><span class="n">colorclip</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">pos</span><span class="p">)])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">CompositeVideoClip</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">pos</span><span class="p">)],</span>
                                        <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
                                        <span class="n">bg_color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ImageClip</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="s2">&quot;__call__&quot;</span><span class="p">))</span>
                <span class="ow">and</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">,</span> <span class="n">ImageClip</span><span class="p">))):</span>
            <span class="n">new_result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">to_ImageClip</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">new_result</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">to_ImageClip</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">new_result</span><span class="o">.</span><span class="n">set_duration</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">duration</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="VideoClip.set_make_frame"><a class="viewcode-back" href="../../../ref/VideoClip/VideoClip.html#moviepy.video.VideoClip.VideoClip.set_make_frame">[docs]</a>    <span class="nd">@outplace</span>
    <span class="k">def</span> <span class="nf">set_make_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mf</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Change the clip&#39;s ``get_frame``.</span>

<span class="sd">        Returns a copy of the VideoClip instance, with the make_frame</span>
<span class="sd">        attribute set to `mf`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">make_frame</span> <span class="o">=</span> <span class="n">mf</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_frame</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></div>

<div class="viewcode-block" id="VideoClip.set_audio"><a class="viewcode-back" href="../../../ref/VideoClip/VideoClip.html#moviepy.video.VideoClip.VideoClip.set_audio">[docs]</a>    <span class="nd">@outplace</span>
    <span class="k">def</span> <span class="nf">set_audio</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">audioclip</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Attach an AudioClip to the VideoClip.</span>

<span class="sd">        Returns a copy of the VideoClip instance, with the `audio`</span>
<span class="sd">        attribute set to ``audio``, which must be an AudioClip instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">audio</span> <span class="o">=</span> <span class="n">audioclip</span></div>

<div class="viewcode-block" id="VideoClip.set_mask"><a class="viewcode-back" href="../../../ref/VideoClip/VideoClip.html#moviepy.video.VideoClip.VideoClip.set_mask">[docs]</a>    <span class="nd">@outplace</span>
    <span class="k">def</span> <span class="nf">set_mask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mask</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the clip&#39;s mask.</span>

<span class="sd">        Returns a copy of the VideoClip with the mask attribute set to</span>
<span class="sd">        ``mask``, which must be a greyscale (values in 0-1) VideoClip&quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">mask</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">mask</span><span class="o">.</span><span class="n">ismask</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span></div>

<div class="viewcode-block" id="VideoClip.set_opacity"><a class="viewcode-back" href="../../../ref/VideoClip/VideoClip.html#moviepy.video.VideoClip.VideoClip.set_opacity">[docs]</a>    <span class="nd">@add_mask_if_none</span>
    <span class="nd">@outplace</span>
    <span class="k">def</span> <span class="nf">set_opacity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the opacity/transparency level of the clip.</span>

<span class="sd">        Returns a semi-transparent copy of the clip where the mask is</span>
<span class="sd">        multiplied by ``op`` (any float, normally between 0 and 1).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">fl_image</span><span class="p">(</span><span class="k">lambda</span> <span class="n">pic</span><span class="p">:</span> <span class="n">op</span> <span class="o">*</span> <span class="n">pic</span><span class="p">)</span></div>

<div class="viewcode-block" id="VideoClip.set_position"><a class="viewcode-back" href="../../../ref/VideoClip/VideoClip.html#moviepy.video.VideoClip.VideoClip.set_position">[docs]</a>    <span class="nd">@apply_to_mask</span>
    <span class="nd">@outplace</span>
    <span class="k">def</span> <span class="nf">set_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">relative</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the clip&#39;s position in compositions.</span>

<span class="sd">        Sets the position that the clip will have when included</span>
<span class="sd">        in compositions. The argument ``pos`` can be either a couple</span>
<span class="sd">        ``(x,y)`` or a function ``t-&gt; (x,y)``. `x` and `y` mark the</span>
<span class="sd">        location of the top left corner of the clip, and can be</span>
<span class="sd">        of several types.</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------</span>

<span class="sd">        &gt;&gt;&gt; clip.set_position((45,150)) # x=45, y=150</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # clip horizontally centered, at the top of the picture</span>
<span class="sd">        &gt;&gt;&gt; clip.set_position((&quot;center&quot;,&quot;top&quot;))</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # clip is at 40% of the width, 70% of the height:</span>
<span class="sd">        &gt;&gt;&gt; clip.set_position((0.4,0.7), relative=True)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # clip&#39;s position is horizontally centered, and moving up !</span>
<span class="sd">        &gt;&gt;&gt; clip.set_position(lambda t: (&#39;center&#39;, 50+t) )</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relative_pos</span> <span class="o">=</span> <span class="n">relative</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="s1">&#39;__call__&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">pos</span></div>

    <span class="c1"># --------------------------------------------------------------</span>
    <span class="c1"># CONVERSIONS TO OTHER TYPES</span>

<div class="viewcode-block" id="VideoClip.to_ImageClip"><a class="viewcode-back" href="../../../ref/VideoClip/VideoClip.html#moviepy.video.VideoClip.VideoClip.to_ImageClip">[docs]</a>    <span class="nd">@convert_to_seconds</span><span class="p">([</span><span class="s1">&#39;t&#39;</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">to_ImageClip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">with_mask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns an ImageClip made out of the clip&#39;s frame at time ``t``,</span>
<span class="sd">        which can be expressed in seconds (15.35), in (min, sec),</span>
<span class="sd">        in (hour, min, sec), or as a string: &#39;01:03:05.35&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">newclip</span> <span class="o">=</span> <span class="n">ImageClip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_frame</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">ismask</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ismask</span><span class="p">,</span>
                            <span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">with_mask</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">newclip</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="o">.</span><span class="n">to_ImageClip</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">newclip</span></div>

<div class="viewcode-block" id="VideoClip.to_mask"><a class="viewcode-back" href="../../../ref/VideoClip/VideoClip.html#moviepy.video.VideoClip.VideoClip.to_mask">[docs]</a>    <span class="k">def</span> <span class="nf">to_mask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">canal</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a mask a video clip made from the clip.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ismask</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">newclip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fl_image</span><span class="p">(</span><span class="k">lambda</span> <span class="n">pic</span><span class="p">:</span>
                                    <span class="mf">1.0</span> <span class="o">*</span> <span class="n">pic</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">canal</span><span class="p">]</span> <span class="o">/</span> <span class="mi">255</span><span class="p">)</span>
            <span class="n">newclip</span><span class="o">.</span><span class="n">ismask</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="n">newclip</span></div>

<div class="viewcode-block" id="VideoClip.to_RGB"><a class="viewcode-back" href="../../../ref/VideoClip/VideoClip.html#moviepy.video.VideoClip.VideoClip.to_RGB">[docs]</a>    <span class="k">def</span> <span class="nf">to_RGB</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a non-mask video clip made from the mask video clip.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ismask</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">pic</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="p">[</span><span class="mi">255</span> <span class="o">*</span> <span class="n">pic</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
            <span class="n">newclip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fl_image</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="n">newclip</span><span class="o">.</span><span class="n">ismask</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">return</span> <span class="n">newclip</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span></div>

    <span class="c1"># ----------------------------------------------------------------</span>
    <span class="c1"># Audio</span>

<div class="viewcode-block" id="VideoClip.without_audio"><a class="viewcode-back" href="../../../ref/VideoClip/VideoClip.html#moviepy.video.VideoClip.VideoClip.without_audio">[docs]</a>    <span class="nd">@outplace</span>
    <span class="k">def</span> <span class="nf">without_audio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove the clip&#39;s audio.</span>

<span class="sd">        Return a copy of the clip with audio set to None.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">audio</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="VideoClip.afx"><a class="viewcode-back" href="../../../ref/VideoClip/VideoClip.html#moviepy.video.VideoClip.VideoClip.afx">[docs]</a>    <span class="nd">@outplace</span>
    <span class="k">def</span> <span class="nf">afx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fun</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">k</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Transform the clip&#39;s audio.</span>

<span class="sd">        Return a new clip whose audio has been transformed by ``fun``.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">audio</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">audio</span><span class="o">.</span><span class="n">fx</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">k</span><span class="p">)</span></div></div>


<span class="k">class</span> <span class="nc">DataVideoClip</span><span class="p">(</span><span class="n">VideoClip</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class of video clips whose successive frames are functions</span>
<span class="sd">    of successive datasets</span>

<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>
<span class="sd">    data</span>
<span class="sd">      A liste of datasets, each dataset being used for one frame of the clip</span>

<span class="sd">    data_to_frame</span>
<span class="sd">      A function d -&gt; video frame, where d is one element of the list `data`</span>

<span class="sd">    fps</span>
<span class="sd">      Number of frames per second in the animation</span>

<span class="sd">    Examples</span>
<span class="sd">    ---------</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">data_to_frame</span><span class="p">,</span> <span class="n">fps</span><span class="p">,</span> <span class="n">ismask</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">has_constant_size</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_to_frame</span> <span class="o">=</span> <span class="n">data_to_frame</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fps</span> <span class="o">=</span> <span class="n">fps</span>
        <span class="n">make_frame</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_to_frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fps</span><span class="o">*</span><span class="n">t</span><span class="p">)])</span>
        <span class="n">VideoClip</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">make_frame</span><span class="p">,</span> <span class="n">ismask</span><span class="o">=</span><span class="n">ismask</span><span class="p">,</span>
                           <span class="n">duration</span><span class="o">=</span><span class="mf">1.0</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">/</span><span class="n">fps</span><span class="p">,</span>
                           <span class="n">has_constant_size</span><span class="o">=</span><span class="n">has_constant_size</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">UpdatedVideoClip</span><span class="p">(</span><span class="n">VideoClip</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class of clips whose make_frame requires some objects to</span>
<span class="sd">    be updated. Particularly practical in science where some</span>
<span class="sd">    algorithm needs to make some steps before a new frame can</span>
<span class="sd">    be generated.</span>

<span class="sd">    UpdatedVideoClips have the following make_frame:</span>

<span class="sd">    &gt;&gt;&gt; def make_frame(t):</span>
<span class="sd">    &gt;&gt;&gt;     while self.world.clip_t &lt; t:</span>
<span class="sd">    &gt;&gt;&gt;         world.update() # updates, and increases world.clip_t</span>
<span class="sd">    &gt;&gt;&gt;     return world.to_frame()</span>

<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>

<span class="sd">    world</span>
<span class="sd">      An object with the following attributes:</span>
<span class="sd">      - world.clip_t : the clip&#39;s time corresponding to the</span>
<span class="sd">          world&#39;s state</span>
<span class="sd">      - world.update() : update the world&#39;s state, (including</span>
<span class="sd">        increasing world.clip_t of one time step)</span>
<span class="sd">      - world.to_frame() : renders a frame depending on the world&#39;s state</span>

<span class="sd">    ismask</span>
<span class="sd">      True if the clip is a WxH mask with values in 0-1</span>

<span class="sd">    duration</span>
<span class="sd">      Duration of the clip, in seconds</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">world</span><span class="p">,</span> <span class="n">ismask</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">world</span> <span class="o">=</span> <span class="n">world</span>

        <span class="k">def</span> <span class="nf">make_frame</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
            <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">world</span><span class="o">.</span><span class="n">clip_t</span> <span class="o">&lt;</span> <span class="n">t</span><span class="p">:</span>
                <span class="n">world</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">world</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>

        <span class="n">VideoClip</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">make_frame</span><span class="o">=</span><span class="n">make_frame</span><span class="p">,</span>
                           <span class="n">ismask</span><span class="o">=</span><span class="n">ismask</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">)</span>


<span class="sd">&quot;&quot;&quot;---------------------------------------------------------------------</span>

<span class="sd">    ImageClip (base class for all &#39;static clips&#39;) and its subclasses</span>
<span class="sd">    ColorClip and TextClip.</span>
<span class="sd">    I would have liked to put these in a separate file but Python is bad</span>
<span class="sd">    at cyclic imports.</span>

<span class="sd">---------------------------------------------------------------------&quot;&quot;&quot;</span>


<div class="viewcode-block" id="ImageClip"><a class="viewcode-back" href="../../../ref/VideoClip/VideoClip.html#moviepy.video.VideoClip.ImageClip">[docs]</a><span class="k">class</span> <span class="nc">ImageClip</span><span class="p">(</span><span class="n">VideoClip</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for non-moving VideoClips.</span>

<span class="sd">    A video clip originating from a picture. This clip will simply</span>
<span class="sd">    display the given picture at all times.</span>

<span class="sd">    Examples</span>
<span class="sd">    ---------</span>

<span class="sd">    &gt;&gt;&gt; clip = ImageClip(&quot;myHouse.jpeg&quot;)</span>
<span class="sd">    &gt;&gt;&gt; clip = ImageClip( someArray ) # a Numpy array represent</span>

<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>

<span class="sd">    img</span>
<span class="sd">      Any picture file (png, tiff, jpeg, etc.) or any array representing</span>
<span class="sd">      an RGB image (for instance a frame from a VideoClip).</span>

<span class="sd">    ismask</span>
<span class="sd">      Set this parameter to `True` if the clip is a mask.</span>

<span class="sd">    transparent</span>
<span class="sd">      Set this parameter to `True` (default) if you want the alpha layer</span>
<span class="sd">      of the picture (if it exists) to be used as a mask.</span>

<span class="sd">    Attributes</span>
<span class="sd">    -----------</span>

<span class="sd">    img</span>
<span class="sd">      Array representing the image of the clip.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">ismask</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">fromalpha</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">VideoClip</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ismask</span><span class="o">=</span><span class="n">ismask</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">string_types</span><span class="p">):</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>  <span class="c1"># img is (now) a RGB(a) numpy array</span>

            <span class="k">if</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">fromalpha</span><span class="p">:</span>
                    <span class="n">img</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">img</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">/</span> <span class="mi">255</span>
                <span class="k">elif</span> <span class="n">ismask</span><span class="p">:</span>
                    <span class="n">img</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">img</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">255</span>
                <span class="k">elif</span> <span class="n">transparent</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">ImageClip</span><span class="p">(</span>
                        <span class="mf">1.0</span> <span class="o">*</span> <span class="n">img</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="n">ismask</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">ismask</span><span class="p">:</span>
                <span class="n">img</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">img</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">255</span>

        <span class="c1"># if the image was just a 2D mask, it should arrive here</span>
        <span class="c1"># unchanged</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">make_frame</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">img</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">img</span> <span class="o">=</span> <span class="n">img</span>

<div class="viewcode-block" id="ImageClip.fl"><a class="viewcode-back" href="../../../ref/VideoClip/VideoClip.html#moviepy.video.VideoClip.ImageClip.fl">[docs]</a>    <span class="k">def</span> <span class="nf">fl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fl</span><span class="p">,</span> <span class="n">apply_to</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keep_duration</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;General transformation filter.</span>

<span class="sd">        Equivalent to VideoClip.fl . The result is no more an</span>
<span class="sd">        ImageClip, it has the class VideoClip (since it may be animated)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">apply_to</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">apply_to</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># When we use fl on an image clip it may become animated.</span>
        <span class="c1"># Therefore the result is not an ImageClip, just a VideoClip.</span>
        <span class="n">newclip</span> <span class="o">=</span> <span class="n">VideoClip</span><span class="o">.</span><span class="n">fl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fl</span><span class="p">,</span> <span class="n">apply_to</span><span class="o">=</span><span class="n">apply_to</span><span class="p">,</span>
                               <span class="n">keep_duration</span><span class="o">=</span><span class="n">keep_duration</span><span class="p">)</span>
        <span class="n">newclip</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">=</span> <span class="n">VideoClip</span>
        <span class="k">return</span> <span class="n">newclip</span></div>

<div class="viewcode-block" id="ImageClip.fl_image"><a class="viewcode-back" href="../../../ref/VideoClip/VideoClip.html#moviepy.video.VideoClip.ImageClip.fl_image">[docs]</a>    <span class="nd">@outplace</span>
    <span class="k">def</span> <span class="nf">fl_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image_func</span><span class="p">,</span> <span class="n">apply_to</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Image-transformation filter.</span>

<span class="sd">        Does the same as VideoClip.fl_image, but for ImageClip the</span>
<span class="sd">        tranformed clip is computed once and for all at the beginning,</span>
<span class="sd">        and not for each &#39;frame&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">apply_to</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">apply_to</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="n">image_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_frame</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">make_frame</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">arr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">img</span> <span class="o">=</span> <span class="n">arr</span>

        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">apply_to</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">new_a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">fl_image</span><span class="p">(</span><span class="n">image_func</span><span class="p">)</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">new_a</span><span class="p">)</span></div>

<div class="viewcode-block" id="ImageClip.fl_time"><a class="viewcode-back" href="../../../ref/VideoClip/VideoClip.html#moviepy.video.VideoClip.ImageClip.fl_time">[docs]</a>    <span class="nd">@outplace</span>
    <span class="k">def</span> <span class="nf">fl_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_func</span><span class="p">,</span> <span class="n">apply_to</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">keep_duration</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Time-transformation filter.</span>

<span class="sd">        Applies a transformation to the clip&#39;s timeline</span>
<span class="sd">        (see Clip.fl_time).</span>

<span class="sd">        This method does nothing for ImageClips (but it may affect their</span>
<span class="sd">        masks or their audios). The result is still an ImageClip.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">apply_to</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">apply_to</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mask&#39;</span><span class="p">,</span> <span class="s1">&#39;audio&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">apply_to</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">new_a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">fl_time</span><span class="p">(</span><span class="n">time_func</span><span class="p">)</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">new_a</span><span class="p">)</span></div></div>


<span class="c1"># ##</span>
<span class="c1">#</span>
<span class="c1"># The old functions to_videofile, to_gif, to_images sequences have been</span>
<span class="c1"># replaced by the more explicite write_videofile, write_gif, etc.</span>

<span class="n">VideoClip</span><span class="o">.</span><span class="n">set_pos</span> <span class="o">=</span> <span class="n">deprecated_version_of</span><span class="p">(</span><span class="n">VideoClip</span><span class="o">.</span><span class="n">set_position</span><span class="p">,</span>
                                          <span class="s1">&#39;set_pos&#39;</span><span class="p">)</span>
<span class="n">VideoClip</span><span class="o">.</span><span class="n">to_videofile</span> <span class="o">=</span> <span class="n">deprecated_version_of</span><span class="p">(</span><span class="n">VideoClip</span><span class="o">.</span><span class="n">write_videofile</span><span class="p">,</span>
                                               <span class="s1">&#39;to_videofile&#39;</span><span class="p">)</span>
<span class="n">VideoClip</span><span class="o">.</span><span class="n">to_gif</span> <span class="o">=</span> <span class="n">deprecated_version_of</span><span class="p">(</span><span class="n">VideoClip</span><span class="o">.</span><span class="n">write_gif</span><span class="p">,</span> <span class="s1">&#39;to_gif&#39;</span><span class="p">)</span>
<span class="n">VideoClip</span><span class="o">.</span><span class="n">to_images_sequence</span> <span class="o">=</span> <span class="n">deprecated_version_of</span><span class="p">(</span><span class="n">VideoClip</span><span class="o">.</span><span class="n">write_images_sequence</span><span class="p">,</span>
                                                     <span class="s1">&#39;to_images_sequence&#39;</span><span class="p">)</span>


<div class="viewcode-block" id="ColorClip"><a class="viewcode-back" href="../../../ref/VideoClip/VideoClip.html#moviepy.video.VideoClip.ColorClip">[docs]</a><span class="k">class</span> <span class="nc">ColorClip</span><span class="p">(</span><span class="n">ImageClip</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;An ImageClip showing just one color.</span>

<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>

<span class="sd">    size</span>
<span class="sd">      Size (width, height) in pixels of the clip.</span>

<span class="sd">    color</span>
<span class="sd">      If argument ``ismask`` is False, ``color`` indicates</span>
<span class="sd">      the color in RGB of the clip (default is black). If `ismask``</span>
<span class="sd">      is True, ``color`` must be  a float between 0 and 1 (default is 1)</span>

<span class="sd">    ismask</span>
<span class="sd">      Set to true if the clip will be used as a mask.</span>

<span class="sd">    col</span>
<span class="sd">      Has been deprecated. Do not use.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ismask</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">col</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;The `ColorClip` parameter `col` has been deprecated.&quot;</span>
                          <span class="s2">&quot; Please use `color` instead.&quot;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;The arguments `color` and `col` have both been &quot;</span>
                              <span class="s2">&quot;passed to `ColorClip` so `col` has been ignored.&quot;</span><span class="p">,</span>
                              <span class="ne">UserWarning</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">color</span> <span class="o">=</span> <span class="n">col</span>
        <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">size</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">color</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">color</span><span class="p">))</span>
        <span class="n">ImageClip</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="n">w</span> <span class="o">*</span> <span class="n">h</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">shape</span><span class="p">),</span>
                           <span class="n">ismask</span><span class="o">=</span><span class="n">ismask</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">)</span></div>


<div class="viewcode-block" id="TextClip"><a class="viewcode-back" href="../../../ref/VideoClip/VideoClip.html#moviepy.video.VideoClip.TextClip">[docs]</a><span class="k">class</span> <span class="nc">TextClip</span><span class="p">(</span><span class="n">ImageClip</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for autogenerated text clips.</span>

<span class="sd">    Creates an ImageClip originating from a script-generated text image.</span>
<span class="sd">    Requires ImageMagick.</span>

<span class="sd">    Parameters</span>
<span class="sd">    -----------</span>

<span class="sd">    txt</span>
<span class="sd">      A string of the text to write. Can be replaced by argument</span>
<span class="sd">      ``filename``.</span>

<span class="sd">    filename</span>
<span class="sd">      The name of a file in which there is the text to write.</span>
<span class="sd">      Can be provided instead of argument ``txt``</span>

<span class="sd">    size</span>
<span class="sd">      Size of the picture in pixels. Can be auto-set if</span>
<span class="sd">      method=&#39;label&#39;, but mandatory if method=&#39;caption&#39;.</span>
<span class="sd">      the height can be None, it will then be auto-determined.</span>

<span class="sd">    bg_color</span>
<span class="sd">      Color of the background. See ``TextClip.list(&#39;color&#39;)``</span>
<span class="sd">      for a list of acceptable names.</span>

<span class="sd">    color</span>
<span class="sd">      Color of the text. See ``TextClip.list(&#39;color&#39;)`` for a</span>
<span class="sd">      list of acceptable names.</span>

<span class="sd">    font</span>
<span class="sd">      Name of the font to use. See ``TextClip.list(&#39;font&#39;)`` for</span>
<span class="sd">      the list of fonts you can use on your computer.</span>

<span class="sd">    stroke_color</span>
<span class="sd">      Color of the stroke (=contour line) of the text. If ``None``,</span>
<span class="sd">      there will be no stroke.</span>

<span class="sd">    stroke_width</span>
<span class="sd">      Width of the stroke, in pixels. Can be a float, like 1.5.</span>

<span class="sd">    method</span>
<span class="sd">      Either &#39;label&#39; (default, the picture will be autosized so as to fit</span>
<span class="sd">      exactly the size) or &#39;caption&#39; (the text will be drawn in a picture</span>
<span class="sd">      with fixed size provided with the ``size`` argument). If `caption`,</span>
<span class="sd">      the text will be wrapped automagically (sometimes it is buggy, not</span>
<span class="sd">      my fault, complain to the ImageMagick crew) and can be aligned or</span>
<span class="sd">      centered (see parameter ``align``).</span>

<span class="sd">    kerning</span>
<span class="sd">      Changes the default spacing between letters. For</span>
<span class="sd">      instance ``kerning=-1`` will make the letters 1 pixel nearer from</span>
<span class="sd">      ach other compared to the default spacing.</span>

<span class="sd">    align</span>
<span class="sd">      center | East | West | South | North . Will only work if ``method``</span>
<span class="sd">      is set to ``caption``</span>

<span class="sd">    transparent</span>
<span class="sd">      ``True`` (default) if you want to take into account the</span>
<span class="sd">      transparency in the image.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">txt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
                 <span class="n">bg_color</span><span class="o">=</span><span class="s1">&#39;transparent&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="s1">&#39;Courier&#39;</span><span class="p">,</span>
                 <span class="n">stroke_color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stroke_width</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">,</span>
                 <span class="n">kerning</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">interline</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">tempfilename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">temptxt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">remove_temp</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">print_cmd</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">txt</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">temptxt</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">temptxt_fd</span><span class="p">,</span> <span class="n">temptxt</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkstemp</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;.txt&#39;</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>  <span class="c1"># only in Python3 will this work</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">temptxt_fd</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="s1">&#39;UTF8&#39;</span><span class="p">))</span>
                <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>  <span class="c1"># oops, fall back to Python2</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">temptxt_fd</span><span class="p">,</span> <span class="n">txt</span><span class="p">)</span>
                <span class="n">os</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">temptxt_fd</span><span class="p">)</span>
            <span class="n">txt</span> <span class="o">=</span> <span class="s1">&#39;@&#39;</span> <span class="o">+</span> <span class="n">temptxt</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># use a file instead of a text.</span>
            <span class="n">txt</span> <span class="o">=</span> <span class="s2">&quot;@%&quot;</span> <span class="o">+</span> <span class="n">filename</span>

        <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                    <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

        <span class="n">cmd</span> <span class="o">=</span> <span class="p">([</span><span class="n">get_setting</span><span class="p">(</span><span class="s2">&quot;IMAGEMAGICK_BINARY&quot;</span><span class="p">),</span>
               <span class="s2">&quot;-background&quot;</span><span class="p">,</span> <span class="n">bg_color</span><span class="p">,</span>
                <span class="s2">&quot;-fill&quot;</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span>
                <span class="s2">&quot;-font&quot;</span><span class="p">,</span> <span class="n">font</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">fontsize</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cmd</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;-pointsize&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">fontsize</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">kerning</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cmd</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;-kerning&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%0.1f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">kerning</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">stroke_color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cmd</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;-stroke&quot;</span><span class="p">,</span> <span class="n">stroke_color</span><span class="p">,</span> <span class="s2">&quot;-strokewidth&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;</span><span class="si">%.01f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">stroke_width</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cmd</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;-size&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">x</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
        <span class="k">if</span> <span class="n">align</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cmd</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;-gravity&quot;</span><span class="p">,</span> <span class="n">align</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">interline</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cmd</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;-interline-spacing&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">interline</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">tempfilename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tempfile_fd</span><span class="p">,</span> <span class="n">tempfilename</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkstemp</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">tempfile_fd</span><span class="p">)</span>

        <span class="n">cmd</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">txt</span><span class="p">),</span>
                <span class="s2">&quot;-type&quot;</span><span class="p">,</span> <span class="s2">&quot;truecolormatte&quot;</span><span class="p">,</span> <span class="s2">&quot;PNG32:</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">tempfilename</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">print_cmd</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cmd</span><span class="p">))</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">subprocess_call</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">IOError</span><span class="p">,</span> <span class="ne">OSError</span><span class="p">)</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;MoviePy Error: creation of </span><span class="si">%s</span><span class="s2"> failed because of the &quot;</span>
                     <span class="s2">&quot;following error:</span><span class="se">\n\n</span><span class="si">%s</span><span class="s2">.</span><span class="se">\n\n</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>
                     <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;This error can be due to the fact that ImageMagick &quot;</span>
                        <span class="s2">&quot;is not installed on your computer, or (for Windows &quot;</span>
                        <span class="s2">&quot;users) that you didn&#39;t specify the path to the &quot;</span>
                        <span class="s2">&quot;ImageMagick binary in file conf.py, or that the path &quot;</span>
                        <span class="s2">&quot;you specified is incorrect&quot;</span><span class="p">))</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>

        <span class="n">ImageClip</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tempfilename</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="n">transparent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">txt</span> <span class="o">=</span> <span class="n">txt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stroke_color</span> <span class="o">=</span> <span class="n">stroke_color</span>

        <span class="k">if</span> <span class="n">remove_temp</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">tempfilename</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tempfilename</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">temptxt</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">temptxt</span><span class="p">)</span>

<div class="viewcode-block" id="TextClip.list"><a class="viewcode-back" href="../../../ref/VideoClip/VideoClip.html#moviepy.video.VideoClip.TextClip.list">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">list</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the list of all valid entries for the argument of</span>
<span class="sd">        ``TextClip`` given (can be ``font``, ``color``, etc...) &quot;&quot;&quot;</span>

        <span class="n">popen_params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;stdout&quot;</span><span class="p">:</span> <span class="n">sp</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
                        <span class="s2">&quot;stderr&quot;</span><span class="p">:</span> <span class="n">DEVNULL</span><span class="p">,</span>
                        <span class="s2">&quot;stdin&quot;</span><span class="p">:</span> <span class="n">DEVNULL</span><span class="p">}</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;nt&quot;</span><span class="p">:</span>
            <span class="n">popen_params</span><span class="p">[</span><span class="s2">&quot;creationflags&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x08000000</span>

        <span class="n">process</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="n">get_setting</span><span class="p">(</span><span class="s2">&quot;IMAGEMAGICK_BINARY&quot;</span><span class="p">),</span>
                            <span class="s1">&#39;-list&#39;</span><span class="p">,</span> <span class="n">arg</span><span class="p">],</span> <span class="o">**</span><span class="n">popen_params</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">communicate</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">arg</span> <span class="o">==</span> <span class="s1">&#39;font&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">l</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)[</span><span class="mi">8</span><span class="p">:]</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span> <span class="k">if</span> <span class="n">l</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;  Font:&quot;</span><span class="p">)]</span>
        <span class="k">elif</span> <span class="n">arg</span> <span class="o">==</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">l</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="mi">2</span><span class="p">:]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Moviepy:Error! Argument must equal &quot;</span>
                            <span class="s2">&quot;&#39;font&#39; or &#39;color&#39;&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TextClip.search"><a class="viewcode-back" href="../../../ref/VideoClip/VideoClip.html#moviepy.video.VideoClip.TextClip.search">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the of all valid entries which contain ``string`` for the</span>
<span class="sd">           argument ``arg`` of ``TextClip``, for instance</span>

<span class="sd">           &gt;&gt;&gt; # Find all the available fonts which contain &quot;Courier&quot;</span>
<span class="sd">           &gt;&gt;&gt; print ( TextClip.search(&#39;Courier&#39;, &#39;font&#39;) )</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">names_list</span> <span class="o">=</span> <span class="n">TextClip</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names_list</span> <span class="k">if</span> <span class="n">string</span> <span class="ow">in</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span></div></div>
</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2017, Zulko.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>